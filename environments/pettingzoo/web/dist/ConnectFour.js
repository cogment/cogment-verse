import"./chunk-ON5OQYWL.js";import{useCallback as Y,useEffect as J,useMemo as Q,useState as O}from"react";import A from"react";import{useRef as W}from"react";import{useState as F,useRef as T,useCallback as q}from"react";import{useEffect as z,useLayoutEffect as B}from"react";var x=typeof window>"u"?z:B,U=({isPlaying:t,duration:e,startAt:o=0,updateInterval:n=0,onComplete:r,onUpdate:l})=>{let[i,u]=F(o),p=T(0),c=T(o),d=T(o*-1e3),s=T(null),a=T(null),m=T(null),v=y=>{let f=y/1e3;if(a.current===null){a.current=f,s.current=requestAnimationFrame(v);return}let h=f-a.current,g=p.current+h;a.current=f,p.current=g;let $=c.current+(n===0?g:(g/n|0)*n),S=c.current+g,b=typeof e=="number"&&S>=e;u(b?e:$),b||(s.current=requestAnimationFrame(v))},w=()=>{s.current&&cancelAnimationFrame(s.current),m.current&&clearTimeout(m.current),a.current=null},k=q(y=>{w(),p.current=0;let f=typeof y=="number"?y:o;c.current=f,u(f),t&&(s.current=requestAnimationFrame(v))},[t,o]);return x(()=>{if(l?.(i),e&&i>=e){d.current+=e*1e3;let{shouldRepeat:y=!1,delay:f=0,newStartAt:h}=r?.(d.current/1e3)||{};y&&(m.current=setTimeout(()=>k(h),f*1e3))}},[i,e]),x(()=>(t&&(s.current=requestAnimationFrame(v)),w),[t,e,n]),{elapsedTime:i,reset:k}},K=(t,e,o)=>{let n=t/2,r=e/2,l=n-r,i=2*l,u=o==="clockwise"?"1,0":"0,1",p=2*Math.PI*l;return{path:`m ${n},${r} a ${l},${l} 0 ${u} 0,${i} a ${l},${l} 0 ${u} 0,-${i}`,pathLength:p}},P=(t,e)=>t===0||t===e?0:typeof e=="number"?t-e:0,j=t=>({position:"relative",width:t,height:t}),G={display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:0,top:0,width:"100%",height:"100%"},L=(t,e,o,n,r)=>{if(n===0)return e;let l=(r?n-t:t)/n;return e+o*l},R=t=>{var e,o;return(o=(e=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(n,r,l,i)=>`#${r}${r}${l}${l}${i}${i}`).substring(1).match(/.{2}/g))==null?void 0:e.map(n=>parseInt(n,16)))!=null?o:[]},H=(t,e)=>{var o;let{colors:n,colorsTime:r,isSmoothColorTransition:l=!0}=t;if(typeof n=="string")return n;let i=(o=r?.findIndex((a,m)=>a>=e&&e>=r[m+1]))!=null?o:-1;if(!r||i===-1)return n[0];if(!l)return n[i];let u=r[i]-e,p=r[i]-r[i+1],c=R(n[i]),d=R(n[i+1]),s=!!t.isGrowing;return`rgb(${c.map((a,m)=>L(u,a,d[m]-a,p,s)|0).join(",")})`},V=t=>{let{duration:e,initialRemainingTime:o,updateInterval:n,size:r=180,strokeWidth:l=12,trailStrokeWidth:i,isPlaying:u=!1,isGrowing:p=!1,rotation:c="clockwise",onComplete:d,onUpdate:s}=t,a=W(),m=Math.max(l,i??0),{path:v,pathLength:w}=K(r,m,c),{elapsedTime:k}=U({isPlaying:u,duration:e,startAt:P(e,o),updateInterval:n,onUpdate:typeof s=="function"?f=>{let h=Math.ceil(e-f);h!==a.current&&(a.current=h,s(h))}:void 0,onComplete:typeof d=="function"?f=>{var h;let{shouldRepeat:g,delay:$,newInitialRemainingTime:S}=(h=d(f))!=null?h:{};if(g)return{shouldRepeat:g,delay:$,newStartAt:P(e,S)}}:void 0}),y=e-k;return{elapsedTime:k,path:v,pathLength:w,remainingTime:Math.ceil(y),rotation:c,size:r,stroke:H(t,y),strokeDashoffset:L(k,0,w,e,p),strokeWidth:l}},E=t=>{let{children:e,strokeLinecap:o,trailColor:n,trailStrokeWidth:r}=t,{path:l,pathLength:i,stroke:u,strokeDashoffset:p,remainingTime:c,elapsedTime:d,size:s,strokeWidth:a}=V(t);return A.createElement("div",{style:j(s)},A.createElement("svg",{viewBox:`0 0 ${s} ${s}`,width:s,height:s,xmlns:"http://www.w3.org/2000/svg"},A.createElement("path",{d:l,fill:"none",stroke:n??"#d9d9d9",strokeWidth:r??a}),A.createElement("path",{d:l,fill:"none",stroke:u,strokeLinecap:o??"round",strokeWidth:a,strokeDasharray:i,strokeDashoffset:p})),typeof e=="function"&&A.createElement("div",{style:G},e({remainingTime:c,elapsedTime:d,color:u})))};E.displayName="CountdownCircleTimer";import{Button as _,deserializeObservationActionMask as X,DType as Z,KeyboardControlList as ee,OBSERVER_ACTOR_CLASS as te,PlayObserver as re,serializePlayerAction as ne,SimplePlay as ie,Space as I,TEACHER_NOOP_ACTION as ae,useDocumentKeypressListener as le,WEB_ACTOR_NAME as M}from"@cogment/cogment-verse";import{jsx as C,jsxs as D}from"react/jsx-runtime";var oe=1,N=[0,1,2,3,4,5,6],se=new I({discrete:{n:N.length}}),ue=new I({box:{low:{dtype:Z.DTYPE_INT8,shape:[7]}}}),ce=({sendAction:t,observation:e,actorClass:o,...n})=>{let r=e?.currentPlayer,[l,i]=O(0);J(()=>{i(a=>a+1),p(!0)},[r]);let[u,p]=O(!0),c=!u||r===M,d=Y(()=>{c||(t(ae),p(!1))},[t,c]);le(" ",d);let s=Q(()=>{let a=X(ue,e);return N.map(m=>({disabled:!u||r!==M||a[m]!==1,play:()=>{t(ne(se,m))}}))},[u,r,t,e]);return D("div",{...n,children:[C("div",{className:"flex flex-row gap-4 mb-2 px-10",children:N.map(a=>C(_,{className:"flex-1 rounded-full aspect-square",onClick:s[a].play,disabled:s[a].disabled,children:`#${a+1}`},a))}),C("div",{className:"flex flex-row gap-1",children:D(_,{className:"flex-1 flex justify-center items-center gap-2",onClick:d,disabled:c,children:[C("div",{className:"flex-initial",children:C(E,{size:20,strokeWidth:5,strokeLinecap:"square",duration:oe,colors:"#fff",trailColor:"#555",isPlaying:!c,onComplete:d},l)}),C("div",{className:"flex-initial",children:"Step to opponent turn"})]})}),C(ee,{items:[["space","step"]]})]})},pe=({actorParams:t,...e})=>t?.className===te?C(re,{actorParams:t,...e}):C(ie,{actorParams:t,...e,controls:ce}),ke=pe;export{ce as ConnectFourControls,ke as default};
//# sourceMappingURL=ConnectFour.js.map
