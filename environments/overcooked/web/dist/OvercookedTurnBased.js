import{useCallback as C,useEffect as Q,useState as B}from"react";import x from"react";import{useRef as q}from"react";import{useState as F,useRef as S,useCallback as M}from"react";import{useEffect as z,useLayoutEffect as _}from"react";var A=typeof window>"u"?z:_,K=({isPlaying:e,duration:t,startAt:s=0,updateInterval:r=0,onComplete:i,onUpdate:l})=>{let[a,m]=F(s),p=S(0),u=S(s),d=S(s*-1e3),o=S(null),c=S(null),h=S(null),g=f=>{let n=f/1e3;if(c.current===null){c.current=n,o.current=requestAnimationFrame(g);return}let y=n-c.current,k=p.current+y;c.current=n,p.current=k;let E=u.current+(r===0?k:(k/r|0)*r),L=u.current+k,N=typeof t=="number"&&L>=t;m(N?t:E),N||(o.current=requestAnimationFrame(g))},v=()=>{o.current&&cancelAnimationFrame(o.current),h.current&&clearTimeout(h.current),c.current=null},w=M(f=>{v(),p.current=0;let n=typeof f=="number"?f:s;u.current=n,m(n),e&&(o.current=requestAnimationFrame(g))},[e,s]);return A(()=>{if(l?.(a),t&&a>=t){d.current+=t*1e3;let{shouldRepeat:f=!1,delay:n=0,newStartAt:y}=i?.(d.current/1e3)||{};f&&(h.current=setTimeout(()=>w(y),n*1e3))}},[a,t]),A(()=>(e&&(o.current=requestAnimationFrame(g)),v),[e,t,r]),{elapsedTime:a,reset:w}},j=(e,t,s)=>{let r=e/2,i=t/2,l=r-i,a=2*l,m=s==="clockwise"?"1,0":"0,1",p=2*Math.PI*l;return{path:`m ${r},${i} a ${l},${l} 0 ${m} 0,${a} a ${l},${l} 0 ${m} 0,-${a}`,pathLength:p}},D=(e,t)=>e===0||e===t?0:typeof t=="number"?e-t:0,G=e=>({position:"relative",width:e,height:e}),V={display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:0,top:0,width:"100%",height:"100%"},W=(e,t,s,r,i)=>{if(r===0)return t;let l=(i?r-e:e)/r;return t+s*l},U=e=>{var t,s;return(s=(t=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(r,i,l,a)=>`#${i}${i}${l}${l}${a}${a}`).substring(1).match(/.{2}/g))==null?void 0:t.map(r=>parseInt(r,16)))!=null?s:[]},H=(e,t)=>{var s;let{colors:r,colorsTime:i,isSmoothColorTransition:l=!0}=e;if(typeof r=="string")return r;let a=(s=i?.findIndex((c,h)=>c>=t&&t>=i[h+1]))!=null?s:-1;if(!i||a===-1)return r[0];if(!l)return r[a];let m=i[a]-t,p=i[a]-i[a+1],u=U(r[a]),d=U(r[a+1]),o=!!e.isGrowing;return`rgb(${u.map((c,h)=>W(m,c,d[h]-c,p,o)|0).join(",")})`},J=e=>{let{duration:t,initialRemainingTime:s,updateInterval:r,size:i=180,strokeWidth:l=12,trailStrokeWidth:a,isPlaying:m=!1,isGrowing:p=!1,rotation:u="clockwise",onComplete:d,onUpdate:o}=e,c=q(),h=Math.max(l,a??0),{path:g,pathLength:v}=j(i,h,u),{elapsedTime:w}=K({isPlaying:m,duration:t,startAt:D(t,s),updateInterval:r,onUpdate:typeof o=="function"?n=>{let y=Math.ceil(t-n);y!==c.current&&(c.current=y,o(y))}:void 0,onComplete:typeof d=="function"?n=>{var y;let{shouldRepeat:k,delay:E,newInitialRemainingTime:L}=(y=d(n))!=null?y:{};if(k)return{shouldRepeat:k,delay:E,newStartAt:D(t,L)}}:void 0}),f=t-w;return{elapsedTime:w,path:g,pathLength:v,remainingTime:Math.ceil(f),rotation:u,size:i,stroke:H(e,f),strokeDashoffset:W(w,0,v,t,p),strokeWidth:l}},b=e=>{let{children:t,strokeLinecap:s,trailColor:r,trailStrokeWidth:i}=e,{path:l,pathLength:a,stroke:m,strokeDashoffset:p,remainingTime:u,elapsedTime:d,size:o,strokeWidth:c}=J(e);return x.createElement("div",{style:G(o)},x.createElement("svg",{viewBox:`0 0 ${o} ${o}`,width:o,height:o,xmlns:"http://www.w3.org/2000/svg"},x.createElement("path",{d:l,fill:"none",stroke:r??"#d9d9d9",strokeWidth:i??c}),x.createElement("path",{d:l,fill:"none",stroke:m,strokeLinecap:s??"round",strokeWidth:c,strokeDasharray:a,strokeDashoffset:p})),typeof t=="function"&&x.createElement("div",{style:V},t({remainingTime:u,elapsedTime:d,color:m})))};b.displayName="CountdownCircleTimer";import{Button as O,KeyboardControlList as X,OBSERVER_ACTOR_CLASS as Y,PlayObserver as Z,serializePlayerAction as P,SimplePlay as ee,Space as te,useDocumentKeypressListener as T}from"@cogment/cogment-verse";import{jsx as $,jsxs as I}from"react/jsx-runtime";var re=5,R=new te({discrete:{n:6}}),ne=({sendAction:e,fps:t=1,actorClass:s,observation:r,...i})=>{let l=r?.currentPlayer,[a,m]=B(!1),p=C(()=>m(n=>!n),[m]);T("p",p);let u=a,[d,o]=B(0);Q(()=>{o(n=>n+1)},[l]);let c=C(()=>{u||(e(P(R,0)),o(n=>n+1))},[e]);T("ArrowUp",c);let h=C(()=>{u||(e(P(R,1)),o(n=>n+1))},[e]);T("ArrowDown",h);let g=C(()=>{u||(e(P(R,3)),o(n=>n+1))},[e]);T("ArrowLeft",g);let v=C(()=>{u||(e(P(R,2)),o(n=>n+1))},[e]);T("ArrowRight",v);let w=C(()=>{u||(e(P(R,5)),o(n=>n+1))},[e]);T("Enter",w);let f=C(()=>{u||(e(P(R,4)),o(n=>n+1))},[e]);return T("Shift",f),I("div",{...i,children:[I("div",{className:"flex flex-row gap-1",children:[I(O,{className:"flex-1 flex justify-center items-center gap-2",onClick:f,disabled:u,children:[$("div",{className:"flex-initial",children:$(b,{size:20,strokeWidth:5,strokeLinecap:"square",duration:re,colors:"#fff",trailColor:"#555",isPlaying:!a,onComplete:f},d)}),$("div",{className:"flex-initial",children:l?`Step to "${r.currentPlayer}" turn`:"turn timer"})]}),$(O,{className:"flex-1",onClick:p,children:a?"Resume":"Pause"})]}),$(X,{items:[["Left/Right/Up/Down Arrows","Move player left/right/up/down"],["Enter","Interact"],["Shift","Skip to next time step"],["p","Pause/Unpause"]]})]})},ae=({actorParams:e,...t})=>e?.className===Y?$(Z,{actorParams:e,...t}):$(ee,{actorParams:e,...t,controls:ne}),fe=ae;export{ne as OvercookedTurnBasedControls,fe as default};
//# sourceMappingURL=OvercookedTurnBased.js.map
