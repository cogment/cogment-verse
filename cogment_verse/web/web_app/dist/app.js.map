{
  "version": 3,
  "sources": ["../src/app/index.jsx", "../src/app/pages/Play.jsx", "../src/shared/utils/retrievePendingTrials.js", "../src/app/pages/PlayAny.jsx", "../src/app/pages/Error.jsx", "../src/app/pages/Trials.jsx", "../src/shared/hooks/useActiveTrials.js", "../src/app/pages/Root.jsx"],
  "sourcesContent": ["// Copyright 2023 AI Redefined Inc. <dev+cogment@ai-r.com>\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//    http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport React from \"react\";\nimport { createRoot } from \"react-dom/client\";\nimport \"./index.css\";\nimport Play from \"./pages/Play\";\nimport { loader as playAnyLoader } from \"./pages/PlayAny\";\nimport Error from \"./pages/Error\";\nimport Trials from \"./pages/Trials\";\nimport Root from \"./pages/Root\";\nimport { createBrowserRouter, createRoutesFromElements, Route, RouterProvider } from \"react-router-dom\";\n\nconst router = createBrowserRouter(\n  createRoutesFromElements(\n    <Route path=\"/\" element={<Root />}>\n      <Route index element={<Trials />} errorElement={<Error />} />\n      <Route path=\"play\" errorElement={<Error />}>\n        <Route index loader={playAnyLoader} />\n        <Route path=\":trialId\" element={<Play />} />\n      </Route>\n    </Route>\n  )\n);\n\nconst root = createRoot(document.getElementById(\"root\"));\n\nroot.render(\n  <React.StrictMode>\n    <RouterProvider router={router} />\n  </React.StrictMode>\n);\n", "// Copyright 2023 AI Redefined Inc. <dev+cogment@ai-r.com>\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//    http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { useCallback } from \"react\";\nimport { useParams, useNavigate } from \"react-router-dom\";\nimport { DynamicallyImportedComponent } from \"../../shared\";\nimport { WEB_BASE_URL } from \"../../shared/utils/constants\";\n\nconst Play = () => {\n  const { trialId } = useParams();\n  const navigate = useNavigate();\n  const redirectToPlayAny = useCallback(() => navigate(\"..\"), [navigate]);\n\n  return (\n    <DynamicallyImportedComponent\n      moduleUrl={`${WEB_BASE_URL}/components/environments/environments.gym.environment.Environment/LunarLander-v2/GymLunarLander.js`}\n      trialId={trialId}\n      onTrialEnd={redirectToPlayAny}\n    />\n  );\n};\n\nexport default Play;\n", "// Copyright 2023 AI Redefined Inc. <dev+cogment@ai-r.com>\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//    http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Context, TrialState } from \"@cogment/cogment-js-sdk\";\n\nexport const retrievePendingTrials = async (cogSettings, cogmentOrchestratorWebEndpoint, timeout = 5000) => {\n  const context = new Context(cogSettings, \"cogment_verse_web\");\n  const trialController = context.getController(cogmentOrchestratorWebEndpoint);\n  let cancelled = false;\n  const pendingTrials = new Set();\n\n  return await Promise.race([\n    new Promise(async (resolve, reject) => {\n      try {\n        for await (const trialEvent of trialController.watchTrials()) {\n          if (cancelled) {\n            console.log(\"[retrievePendingTrials] watch trials cancelled\");\n            return;\n          }\n          if (trialEvent.state === TrialState.PENDING) {\n            pendingTrials.add(trialEvent.trialId);\n          } else {\n            pendingTrials.delete(trialEvent.trialId);\n          }\n        }\n        resolve([...pendingTrials]);\n      } catch (error) {\n        console.log(\"erroror\", error);\n        reject(error);\n      }\n    }),\n    new Promise((resolve) => {\n      setTimeout(() => {\n        cancelled = true;\n        resolve([...pendingTrials]);\n      }, timeout);\n    }),\n  ]);\n};\n", "// Copyright 2023 AI Redefined Inc. <dev+cogment@ai-r.com>\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//    http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { redirect } from \"react-router-dom\";\nimport { retrievePendingTrials } from \"../../shared/utils/retrievePendingTrials\";\n\nimport { cogSettings } from \"../../CogSettings\";\nimport { ORCHESTRATOR_WEB_ENDPOINT } from \"../../shared/utils/constants\";\n\nexport const loader = async () => {\n  const pendingTrials = await retrievePendingTrials(cogSettings, ORCHESTRATOR_WEB_ENDPOINT, 500);\n  if (pendingTrials.length === 0) {\n    return redirect(\"/\");\n  }\n  return redirect(pendingTrials[0]);\n};\n", "// Copyright 2023 AI Redefined Inc. <dev+cogment@ai-r.com>\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//    http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport React from \"react\";\nimport { useRouteError } from \"react-router-dom\";\nimport { Button, Error as ErrorComponent } from \"../../shared\";\n\nconst Error = () => {\n  const error = useRouteError();\n  return (\n    <ErrorComponent title=\"Oups...\" error={error}>\n      <Button to=\"/\" reloadDocument>\n        Retry\n      </Button>\n    </ErrorComponent>\n  );\n};\n\nexport default Error;\n", "// Copyright 2023 AI Redefined Inc. <dev+cogment@ai-r.com>\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//    http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { TrialState } from \"@cogment/cogment-js-sdk\";\nimport { Link } from \"react-router-dom\";\nimport { useActiveTrials } from \"../../shared/hooks/useActiveTrials\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faCircleNotch } from \"@fortawesome/free-solid-svg-icons\";\nimport clsx from \"clsx\";\n\nimport { cogSettings } from \"../../CogSettings\";\nimport { ORCHESTRATOR_WEB_ENDPOINT } from \"../../shared/utils/constants\";\n\nconst trialStatePillClassNames = [\"rounded-md\", \"py-2\", \"px-5\", \"text-center\", \"text-sm\", \"text-white\"];\nconst TrialStatePill = ({ state, trialId, ...otherProps }) => {\n  if (state === TrialState.PENDING) {\n    return (\n      <Link\n        className={clsx(trialStatePillClassNames, \"bg-emerald-500 hover:bg-emerald-800\")}\n        to={`/play/${trialId}`}\n        {...otherProps}\n      >\n        <FontAwesomeIcon icon={faCircleNotch} shake /> Join pending trial...\n      </Link>\n    );\n  } else if (state === TrialState.RUNNING) {\n    return (\n      <span className={clsx(trialStatePillClassNames, \"bg-slate-600\")} {...otherProps}>\n        <FontAwesomeIcon icon={faCircleNotch} spin /> Trial running\n      </span>\n    );\n  } else {\n    return (\n      <span className={clsx(trialStatePillClassNames, \"bg-red-600\")} {...otherProps}>\n        {state}\n      </span>\n    );\n  }\n};\n\nconst Trials = () => {\n  const trials = useActiveTrials(cogSettings, ORCHESTRATOR_WEB_ENDPOINT);\n  return (\n    <div>\n      <h1 className=\"text-xl font-semibold mt-5\">Active trials</h1>\n      <ul className=\"my-5 flex flex-col\">\n        {trials.map(({ trialId, state }, index) => (\n          <li key={index} className={clsx(\"flex flex-row items-center p-2\", { \"bg-slate-100\": index % 2 === 0 })}>\n            <div className=\"grow font-medium font-mono\">{trialId}</div>\n            <TrialStatePill state={state} trialId={trialId} />\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n};\n\nexport default Trials;\n", "// Copyright 2023 AI Redefined Inc. <dev+cogment@ai-r.com>\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//    http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Context, TrialState } from \"@cogment/cogment-js-sdk\";\nimport { useEffect, useState } from \"react\";\n\nconst sleep = async (delayMs) => new Promise((resolve) => setTimeout(resolve, delayMs));\n\nexport const useActiveTrials = (cogSettings, cogmentOrchestratorWebEndpoint, retryDelayMs = 500) => {\n  const [trials, setTrials] = useState([]);\n\n  useEffect(() => {\n    const context = new Context(cogSettings, \"cogment_verse_web\");\n    const trialController = context.getController(cogmentOrchestratorWebEndpoint);\n\n    let cancelled = false;\n\n    const watchTrials = async (retryNum) => {\n      const watchTrialsGenerator = trialController.watchTrials();\n\n      const delayMs = retryNum * retryDelayMs;\n      try {\n        for await (const trialEvent of watchTrialsGenerator) {\n          if (cancelled) {\n            console.log(\"[useActiveTrials] watch trials cancelled\");\n            return;\n          }\n          if (trialEvent.state === TrialState.ENDED) {\n            setTrials((trials) => trials.filter(({ trialId }) => trialId !== trialEvent.trialId));\n            continue;\n          }\n          setTrials((trials) => {\n            const trialIdx = trials.findIndex(({ trialId }) => trialId === trialEvent.trialId);\n            if (trialIdx === -1) {\n              return [...trials, { trialId: trialEvent.trialId, state: trialEvent.state }];\n            }\n            if (trials[trialIdx].state !== trialEvent.state) {\n              trials[trialIdx].state = trialEvent.state;\n              return [...trials];\n            }\n            return trials;\n          });\n        }\n        console.warn(`[useActiveTrials] watch trials returned early, restarting in ${delayMs}ms`);\n      } catch (error) {\n        console.warn(`[useActiveTrials] error during watch trials (${error}), restarting in ${delayMs}ms`);\n      }\n      await sleep(delayMs);\n      await watchTrials(retryNum + 1);\n    };\n\n    watchTrials(0);\n\n    return () => {\n      cancelled = true;\n    };\n  }, [cogSettings, cogmentOrchestratorWebEndpoint, retryDelayMs]);\n\n  return trials;\n};\n", "// Copyright 2023 AI Redefined Inc. <dev+cogment@ai-r.com>\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//    http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Outlet } from \"react-router-dom\";\n\nconst Root = () => (\n  <div className=\"max-w-screen-xl mx-auto min-h-fit\">\n    <Outlet />\n  </div>\n);\n\nexport default Root;\n"],
  "mappings": "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",
  "names": ["import_react", "import_client", "import_react", "import_jsx_runtime", "Play", "trialId", "useParams", "navigate", "useNavigate", "redirectToPlayAny", "DynamicallyImportedComponent", "WEB_BASE_URL", "Play_default", "import_cogment_js_sdk", "retrievePendingTrials", "cogSettings", "cogmentOrchestratorWebEndpoint", "timeout", "trialController", "cancelled", "pendingTrials", "resolve", "reject", "trialEvent", "error", "import_CogSettings", "loader", "pendingTrials", "retrievePendingTrials", "ORCHESTRATOR_WEB_ENDPOINT", "redirect", "import_react", "import_jsx_runtime", "Error", "error", "useRouteError", "Button", "Error_default", "import_cogment_js_sdk", "import_cogment_js_sdk", "import_react", "sleep", "delayMs", "resolve", "useActiveTrials", "cogSettings", "cogmentOrchestratorWebEndpoint", "retryDelayMs", "trials", "setTrials", "trialController", "cancelled", "watchTrials", "retryNum", "watchTrialsGenerator", "trialEvent", "trialId", "trialIdx", "error", "import_CogSettings", "import_jsx_runtime", "trialStatePillClassNames", "TrialStatePill", "state", "trialId", "otherProps", "Link", "clsx_m_default", "FontAwesomeIcon", "faCircleNotch", "Trials", "trials", "useActiveTrials", "ORCHESTRATOR_WEB_ENDPOINT", "index", "Trials_default", "import_jsx_runtime", "Root", "Outlet", "Root_default", "import_jsx_runtime", "router", "createBrowserRouter", "createRoutesFromChildren", "Route", "Root_default", "Trials_default", "Error_default", "loader", "Play_default", "root", "React", "RouterProvider"]
}
